
KISSY.add("v2/source/atpanel",function(a){function b(){var a=window.goldlog,b=[].slice.apply(arguments),c=b.shift();a?a[c]&&a[c].apply(a,b):(window.goldlog_queue||(window.goldlog_queue=[])).push({action:"goldlog."+c,arguments:b})}var c={},d=["send","emit"];return a.each(d,function(d){c[d]=function(){var c=a.makeArray(arguments);c.unshift(d),b.apply(window,c)}}),c}),KISSY.add("v2/source/mvc",function(a){function b(a){this.namespace=a}function c(a){return a+="",a.charAt(0).toUpperCase()+a.substring(1)}a.log("mvc is started");var d=a.DOM,e=a.JSON,f=new a.Base;a.augment(b,{set:function(b,c){var d=this;return a.isObject(b)?void a.each(b,function(a,b){d.set(b,a)}):void f.set(d.namespace+":"+b,c)},get:function(a){return f.get(this.namespace+":"+a)},onDataChange:function(b,d){function e(){var c,e=[];try{a.each(b,function(b){var c=f.get(b);if(a.isUndefined(c)||a.isNull(c))throw"datadeletion";e.push(c)})}catch(g){return}c=d.apply(h.control,e),c&&h.set(c)}var g=[],h=this;return a.isUndefined(b)?void d.apply(h.control):(a.isString(b)&&(b=[b]),a.each(b,function(a,d){-1===a.indexOf(":")&&(a=b[d]=h.namespace+":"+a),g.push("after"+c(a)+"Change")}),f.on(g.join(" "),e),void e())}});var g=function(a){this.model=a};a.augment(g,{getData:function(a){this.model.set(e.parse(d.html(a)))},update:function(a,b){this.model.set(a,b)},use:function(a){this.model.onDataChange(a.need,a.run)}});var h=function(c){return f[c]?void a.log("namespace"+c+"is used!"):(f[c]=!0,this.model=new b(c),this.model.control=this,void(this.view=new g(this.model)))};return a.augment(h,g),a.log("mvc is ok"),a.log(["pipeData:",f.__attrVals]),h}),KISSY.add("v2/source/category/protocol",function(a){var b=a.DOM,c=a.Event,d=function(){function d(){var a=e.container,c=b.viewportHeight(),d=b.docWidth(),f=parseInt(b.height(a),10),g=parseInt(b.width(a),10);b.css(a,"left",(d-g)/2+"px"),b.css(a,"top",(c-f)/2+b.scrollTop()+"px")}var e={},f=document.createElement("iframe");return f.className="overlayer",f.src="about:blank",{init:function(g,h){document.documentElement;a.mix(e,h||{}),e.container=g,b.css(g,"display","none"),b.css(f,"height",b.docHeight()+"px"),b.css(f,"width","100%"),d(),c.on(window,"resize scroll",d),document.body.appendChild(f)},show:function(){b.css(f,"display","block"),b.css(e.container,"display","block")},hide:function(){b.css(f,"display","none"),b.css(e.container,"display","none")}}}(),e=function(){function e(){j.content.innerHTML=["<strong>\u8bf7\u60a8\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u7b7e\u7f72\u300a\u6d88\u8d39\u8005\u4fdd\u969c\u670d\u52a1\u534f\u8bae\u300b</strong>","<span>\u7b7e\u7f72\u300a\u6d88\u8d39\u8005\u4fdd\u969c\u670d\u52a1\u534f\u8bae\u300b\u8fc7\u7a0b\u4e2d\uff0c\u8bf7\u4e0d\u8981\u5173\u95ed\u672c\u9875\u9762</span>"].join(""),j.btnTo.className="",b.insertBefore(j.btnDone,j.btnTo),c.remove(j.btnTo,"click",e)}function f(){var a=document.createElement("a");return a.innerHTML="\u5df2\u7b7e\u7f72\u534f\u8bae",a.className="advise",a}function g(a){j.msg=document.createElement("span"),j.msg.className="msg-stop",j.msg.innerHTML=a,b.insertBefore(j.msg,j.btnDone),g=h}function h(){b.css(j.msg,"display","block")}function i(){a.io.get(l+"?t="+a.now(),function(b){var c=a.trim(b);"true"==c?(k=!0,j.overlay.hide()):g("\u60a8\u5c1a\u672a\u7b7e\u7f72\u534f\u8bae")})}var j={},k=!1,l="/auction/publish/check_lightning_consignment.htm";return{init:function(b){return j=b||{},j.layer=a.get("#J_ProtocolLayer"),j.layer?(a.mix(j,{content:a.get("#J_LayerContent"),btnTo:a.get("#J_BtnTo"),btnDone:f(),overlay:d}),j.overlay.init(j.layer),c.on(j.btnTo,"click",e),c.on(j.btnDone,"click",i),void j.overlay.show()):void(k=!0)},getStatus:function(){return k}}}();return e},{requires:["../mvc"]}),KISSY.add("v2/source/category/catetype",function(a){var b=a.Event,c=a.DOM;return{init:function(){a.log("cateType init");var d=a.query(".J_CateNavItem"),e=a.get("#J_IptPubType");d&&e&&(e.value&&(c.removeClass(d,"current"),a.each(d,function(a){a.getAttribute("data-value")===e.value&&c.addClass(a,"current")})),b.on(d,"click keydown",function(a){a.keyCode&&13!==a.keyCode||(e.value=this.getAttribute("data-value"),c.removeClass(d,"current"),c.addClass(this,"current"))}))}}}),KISSY.add("v2/source/category/select",function(a){var b=a.Event,c=a.DOM,d={CLICK:"click",FOCUS:"focus"},e="__CATE_DATA",f="data-altname-instance",g="data-menu-instance",h={SELECTED:"cc-selected",FOCUSED:"cc-focused"},i={select:function(b,f){this.selectedItem&&(c.removeClass(this.selectedItem,h.SELECTED),this.selectedItem.removeAttribute("aria-selected")),this.selectedItem=b,b&&(c.addClass(b,h.SELECTED),b.setAttribute("aria-selected","true"),a.log("select-click"),!f&&this.fire(d.CLICK,{data:c.data(b,e)}))},_initCont:function(){var a=this.CLS,b=document.createElement("ul");b.setAttribute("role","listbox"),b.setAttribute("tabIndex","-1"),b.setAttribute("hideFocus","-1"),b.setAttribute("unselectable","on"),b.className=a.CONT,this._wrap.appendChild(b),this._contWrap=b},_initFilter:function(d){var e=document.createElement("div"),f=document.createElement("label"),g=document.createElement("input"),h=this.CLS.FILTER,i=h+a.guid();e.className=h;var j=a.substitute("\u5f53\u524d\u7b2c{level}\u7ea7\u7c7b\u76ee\uff0c\u56de\u8f66\u9009\u62e9\u7c7b\u76ee/\u5c5e\u6027",{level:this.level+1});d=(d||"")+'<i style="display:none;">'+j+"</i>",f.innerHTML=d,f.setAttribute("for",i),g.setAttribute("role","textbox"),g.setAttribute("autocomplete","off"),g.setAttribute("ARIA-LABEL",j+(this.level>0?",Shift \u952e\u52a0 Table \u952e\u56de\u5230\u4e0a\u4e00\u7ea7":"")),g.id=i,e.appendChild(f),e.appendChild(g),this._input=g,this._label=f,this.elFilter=e,this.wrap.appendChild(e),a.UA.ie<=7&&b.on(f,"click",function(){try{g.focus()}catch(a){}}),b.on(g,"valuechange",function(){var a=c.val(g);""!==a?c.hide(f):c.show(f)})},_searchMode:function(a){c[a?"addClass":"removeClass"](this._wrap,"search-mode"),this.isSearchMode=a},filter:function(){var b=this,d=this.CLS,g=c.val(b._input);this._searchMode(""!==g);var h=c.query("."+d.GROUP,this._contWrap);a.each(h,function(b){var h=c.query("."+d.ITEM,b),i=h.length,j=0;a.each(h,function(a){var b,h=c.data(a,e),i=h.content,k=h.pinyin,l=c.data(a,f);(b=i.indexOf(g))>-1||(b=k.indexOf(g.toLowerCase()))>-1?(g&&(i=i.substring(0,b)+"<span class='"+d.HIT+"'>"+i.substring(b,b+g.length)+"</span>"+i.substring(b+g.length,i.length)),a.style.display="",l&&l.show(),a.innerHTML=i):(l&&l.hide(),a.style.display="none",j++)}),j===i?c.hide(b):c.show(b)}),this._render()},_render:function(){var a=c.outerHeight(this._contWrap,!0),b=192;a>c.height("#cate-cascading")&&(b=176),c.width(this._input,b)},_initKeyEvents:function(){var d,e,f=this,g=f.CLS;b.on(this._input,"keyup",function(b){e||(e=c.query("."+g.ITEM,f._contWrap));var h=b.keyCode,i=f.focusItem,j=[13,40,38],k=e;if(a.inArray(h,j)&&(b.preventDefault(),f.isSearchMode&&(k=a.filter(e,function(a){return"none"!==c.css(a,"display")})),13===h?f.select(i):40===h?d=i?k[a.indexOf(i,k)+1]:k[0]:38===h&&(d=i?k[a.indexOf(i,k)-1]:k[k.length-1]),d)){f._input.value=c.text(d);try{f._input.select()}catch(l){}f.focus(d)}})},addGroup:function(b,d,f){var g=this.CLS,h=document.createElement("li"),i=document.createElement("ul");i.className=g.GCONT,f.content&&(h.innerHTML='<div class="'+g.GNAME+'" id="'+g.GNAME+a.guid()+'">'+f.content+"</div>"),h.className=g.GROUP+" "+(f.elCls||""),c.data(h,e,f),this.originData=d,this._curCateWrap=i,list=this.addChildren(b,d,h),h.appendChild(i),this._contWrap.appendChild(h),this.fire("groupRender",{group:h,list:i,data:f})},addChildren:function(b,c,d){var e,f=this,g=(this.CLS,this._curCateWrap),h=document.createDocumentFragment(),i=[];return a.each(b.data,function(g){var j=c.sid===g.sid,k=parseInt(g.leaf,10),l=g;a.mix(l,{type:c.type,isBrand:c.isBrand,inpro:c.inpro,leaf:k});var m={isAllowRename:b.isAllowRename,content:g.name,selected:j,elCls:1===k?"":"cc-hasChild-item",pinyin:g.spell,pathData:l};e=f.addChild(m),j&&(f.select(e,1),f.fire("selected",{data:l,group:d,target:e})),i.push(e),h.appendChild(e)}),g.appendChild(h),i},addChild:function(b){var d=this.CLS,f=document.createElement("li");return this.fire("itemRender",{target:f,data:b}),f.innerHTML=b.content,f.id=d.ITEM+a.guid(),f.className=d.ITEM+(b.elCls?" "+b.elCls:""),c.data(f,e,b),f},getItemData:function(a){return c.data(a,e)},focus:function(a){c.removeClass(this.focusItem,h.FOCUSED),this.focusItem=a,a&&(c.addClass(a,h.FOCUSED),this._wrap.setAttribute("aria-activedescendant",a.id),this.view(a))},view:function(a,b){a&&(c.scrollIntoView(a,this._wrap),b&&c.scrollTop(this._wrap,c.scrollTop(this._wrap)-26))},blur:function(){c.removeClass(this.focusItem,h.FOCUSED)},render:function(){this.wrap.setAttribute("tabIndex","-1"),this.wrap.appendChild(this._wrap),this._render&&this._render(),c.data(this.wrap,g,this),this.selectedItem&&this.view(this.selectedItem,!0)},getIntance:function(a){return c.data(a,g)}};return a.mix(i,a.EventTarget),i}),KISSY.add("v2/source/category/tree",function(a,b){function c(a){this.CLS=h,this._init(a)}var d=a.Event,e=a.DOM,f={CLICK:"click",EXPAND:"expand",TOGGLE:"toggle",FOCUS:"focus"},g="__CATE_DATA",h={WRAP:"cc-tree",FILTER:"cc-cbox-filter",CONT:"cc-tree-cont",EXPANDED:"cc-tree-expanded",HIT:"cc-cbox-hit",GROUP:"cc-tree-group",GNAME:"cc-tree-gname",GCONT:"cc-tree-gcont",ITEM:"cc-tree-item"};return a.augment(c,b,a.EventTarget,{_init:function(a){var b=document.createElement("div");b.setAttribute("role","tree"),b.className=h.WRAP,this.wrap=a.wrap,this._wrap=b,this._curCateWrap=b,this.level=a.level,this._initFilter(a.label),this._initCont(),this._initEvents()},_initEvents:function(){var b=this,c=!1;d.on(this._wrap,"click",function(a){var c=a.target;"SPAN"==c.tagName&&e.hasClass(c,h.HIT)&&(c=e.parent(c)),e.hasClass(c,h.GNAME)?(b.toggle(c),b.focus(c)):e.hasClass(c,h.ITEM)&&(b.select(c),b.focus(c)),b._input.focus()}),d.on(this._wrap,"focus",function(){c||b.focus(b.focusItem||e.get("."+h.GNAME,b._wrap)),b.fire(f.FOCUS)});var g,i=[13,40,38,37,39];d.on(this._input,"keyup",function(c){var d=c.keyCode;a.inArray(d,i)||(g&&g.cancel(),g=a.later(function(){b.filter(),g=null},300))}),d.on(this._wrap,"mousedown",function(){c=!0}),d.on(this._wrap,"mouseup",function(){c=!1}),d.on(this._wrap,"blur",function(){b.blur()}),this._initKeyEvents()},expand:function(a,b){b?(a.setAttribute("aria-expanded","true"),e.addClass(a,h.EXPANDED)):(a.setAttribute("aria-expanded","false"),e.removeClass(a,h.EXPANDED)),this._render()},isExpanded:function(a){return e.hasClass(a,h.EXPANDED)},toggle:function(a){var b=a.parentNode,c=e.hasClass(b,h.EXPANDED);this.expand(b,!c),this.fire(f.TOGGLE,{data:e.data(b,g),expanded:c})}}),c},{requires:["./select"]}),KISSY.add("v2/source/category/combobox",function(a,b){function c(a){this.CLS=g,this._init(a)}var d=a.Event,e=a.DOM,f={CLICK:"click",EXPAND:"expand",TOGGLE:"toggle",FOCUS:"focus"},g={WRAP:"cc-cbox",FILTER:"cc-cbox-filter",CONT:"cc-cbox-cont",GCONT:"cc-cbox-gcont",GNAME:"cc-cbox-gname",GROUP:"cc-cbox-group",ITEM:"cc-cbox-item",HIT:"cc-cbox-hit"};return a.augment(c,b,{_init:function(a){var b=document.createElement("div");b.setAttribute("role","combobox"),b.className=g.WRAP,this.wrap=a.wrap,this._wrap=b,this._curCateWrap=b,this.level=a.level,this._initFilter(a.label),this._initCont(),this._initEvents()},_initEvents:function(){var b=this;d.on(this._wrap,"click",function(a){var c=a.target;"SPAN"==c.tagName&&e.hasClass(c,g.HIT)&&(c=e.parent(c)),e.hasClass(c,g.ITEM)&&(b.select(c),b.focus(c)),b._input.focus()}),d.on(this._input,"focus",function(){b.focusItem&&b.focus(b.focusItem),b.fire(f.FOCUS)});var c,h=[13,40,38,37,39];d.on(this._input,"keyup",function(d){var e=d.keyCode;a.inArray(e,h)||(c&&c.cancel(),c=a.later(function(){b.filter(),c=null},300))}),d.on(this._wrap,"blur",function(){b.blur()}),this._initKeyEvents()}}),c},{requires:["./select"]}),KISSY.add("v2/source/category/previewguid",function(a){function b(){g=k.get("#J_GuidWrap"),g&&(i=Sell.Config.get("preview"),h=k.get("h3.caption",g.parentNode))}function c(b){var c=[b.cid,b.pv].join("+"),g=o[c];return g?void e(g.list):(d(!0),void a.io({url:i.url,data:b,dataType:"json",success:function(b){d(!1),b.result?(o[c]=b,e(b.list)):f(a.merge(p[b.code],b))},error:function(){f(p.error)}}))}function d(a){a?(k.html(g,t),k.hide(h)):k.show(h)}function e(b){var c=document.createDocumentFragment();a.each(b,function(a){var b=k.create('<div class="preview"><div class="wrap"></div></div>'),d=new Image,e=k.get(".wrap",b);l.on(d,"load",function(){k.addClass(b,"loaded"),l.detach("load",arguments.callee)}),d.src=a.image,e.appendChild(d),k.append(b,c)}),k.show(h),k.html(g,""),k.removeClass(g,q.join(" ")),k.append(c,g)}function f(b){var c,d=b.sample?a.substitute(n,b):"";b.sample=d,c=a.substitute(m,b),k.hide(h),k.removeClass(g,q.join(" ")),k.addClass(g,b.cls),k.html(g,c)}var g,h,i,j,k=a.DOM,l=a.Event,m='<p class="hint-content">{hint}</p>{sample}<div class="figure"></div>',n='<div class="preview"><img src="{sample}" alt="" /></div>',o={},p={error:{hint:"\u4eb2\uff0c\u51fa\u9519\u5566\u3002<br/>\u8bf7\u7a0d\u540e\u518d\u8bd5\u8bd5\u5427~~",cls:"figure-error"},repeat:{hint:"\u4eb2\uff0c\u8be5\u7c7b\u76ee\u4e0b\u5b9d\u8d1d\u56fe\u7247\u90fd\u662f\u4e00\u6837\u54d2\uff01",cls:"figure-repeat"},empty:{hint:"\u4eb2\uff0c\u518d\u5f80\u4e0b\u9009\u62e9\u8bd5\u8bd5\u6709\u793a\u4f8b\u56fe\u7247\u54df\uff01",cls:"figure-empty"},recently:{hint:"\u4eb2\uff0c\u8fd9\u662f\u65b0\u7c7b\u76ee\uff0c\u6728\u6709\u5546\u54c1\u3002\u60a8\u662f\u7b2c\u4e00\u4e2a\u5403\u8783\u87f9\u7684\u4eba\u54df\uff01",cls:"figure-new"}},q=[],r=300,s=!1;a.each(p,function(a){q.push(a.cls)});var t='<div class="loading"><i class="icon-loading"></i> \u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u7b49\u2026\u2026</div>';return a.ready(function(){var b=k.get("#J_IptCateID");""===a.trim(b.value)&&f(p.empty)}),{request:function(d){if(s||(b(),s=!0),i){if(!d)return void this.clear();var e={cid:d.cateId,pv:d.pv};j&&j.cancel(),j=a.later(function(){c(e)},r)}},clear:function(){f(p.empty)}}}),KISSY.add("v2/source/category/altname",function(a){function b(){this._init.apply(this,arguments)}var c,d=a.DOM,e=a.Event,f=encodeURIComponent,g=5,h='<li class="altwrap"><div class="arrow"><i class="outer"></i><i class="inner"></i></div><div class="layer"><p class="alt-hint">\u60a8\u6700\u591a\u53ef\u4ee5\u81ea\u5b9a\u4e495\u4e2a\u522b\u540d</p><div class="alt-list"><ul class="J_AltList"></ul><div class="actbar"><a class="act-create" href="javascript:void(0);">\u6dfb\u52a0\u65b0\u522b\u540d</a></div></div></div></li>',i='<li class="alt-item" data-id={id}><div class="mode-view"><span class="view-input">{name}</span><a href="javascript:void(0);" class="act-edit">\u4fee\u6539</a><a href="javascript:void(0);" class="act-del">\u5220\u9664</a></div><div class="mode-edit"><button class="act-save" type="button">\u786e\u5b9a</button><div class="flex-wrap"><label for="alt-edit-input-{guid}" class="edit-label">\u6700\u591a\u8f93\u516520\u4e2a\u6c49\u5b57</label><input id="alt-edit-input-{guid}" class="edit-input" type="text" maxlength="20" value="{name}" /></div></div></li>',j="list-full",k="item-hover",l="item-selected",m="edit-mode",n=0,o=1,p=2,q="__ITEM_TIP",r="__ITEM_DATA",s="__Edit_Mode";return a.augment(b,a.EventTarget,{_init:function(b,c,d){var e=this;e.host=b,e.originData=c,e.cid=c.sid,e.hostName=c.name,a.each(d,function(a,b){e.on(b,a)}),c&&c.altData&&c.altData.length>0&&e.render(c.altData),e._bindHost()},_bindHost:function(){var a=this,b=a.host;e.on(b,"click",function(){a.elWrap||a.render()})},_initWrap:function(){var a=this,b=d.create(h);a.elWrap=b,a.elList=d.get("ul.J_AltList",b),a.elListWrap=d.get("div.alt-list",b),e.on(d.get("a.act-create",b),"click",function(b){b.preventDefault();var c=a.addItem();d.append(c,a.elList),a.setFullStatus()}),d.insertAfter(b,a.host)},_rebuildData:function(b){var c=b||{};return c.guid||(c.guid=a.guid()),c.cid=this.cid,c.realName=a.unEscapeHTML(c.name||""),c},_bindEvents:function(a){var b=this,c=d.get(".edit-input",a),f=d.get(".edit-label",a);e.on(a,"mouseenter mouseleave",function(a){var b=a.currentTarget,c="mouseenter"===a.type?"addClass":"removeClass";d[c](b,k)}),e.on(a,"click",function(c){var e=c.target;d.hasClass(e,"act-save")?b.saveItem(a):d.hasClass(e,"act-edit")?(b.sync(a),b.setEditMode(a,!0)):d.hasClass(e,"act-del")?b.delItem(a):d.data(a,s)||b.setSelectedItem(a)}),e.on(c,"click focus",function(a){a.stopPropagation()}),e.on(c,"keydown keyup",function(a){32===a.keyCode&&a.preventDefault();var b=d.val(c);/\s/g.test(b)&&d.val(c,b.replace(/\s/g,""))}),e.on(c,"valuechange",function(){""!==d.val(c)?d.hide(f):d.show(f)}),e.fire(c,"valuechange")},render:function(b){var c,d=this;d.elWrap||(d._initWrap(),!b&&d.fire("flushList")),b&&(c=document.createDocumentFragment(),a.each(b,function(a){var b=d.addItem(a);a.selected&&d.setSelectedItem(b),c.appendChild(b)}),d.elList.appendChild(c),d.setFullStatus())},addItem:function(b){var c=this._rebuildData(b),e=a.substitute(i,c),f=d.create(e);return this.setEditMode(f,!c.name),d.data(f,r,c),this._bindEvents(f),f},saveItem:function(b){var g=this,h=d.data(b,r),i=d.get("input.edit-input",b),j=d.get("button.act-save",b),k=h.id,l=k?o:n;d.prop(j,"disabled",!0),a.IO({url:c.api,dataType:"json",type:"POST",data:{type:l,name:f(d.val(i)),id:k,cid:g.cid,_tb_token_:c.token||""},success:function(a){return a.result?(g.error(b),h.name=a.name||h.name,g._rebuildData(h),a.name&&(d.val(i,h.realName),e.fire(i,"valuechange")),a.id&&(h.id=a.id),g.sync(b),g.setEditMode(b,!1),g.fire("save",{host:b,saveType:l,data:h}),void g.setSelectedItem(b)):void g.error(b,a.msg)},error:function(){alert("\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u2026\u2026")},complete:function(){d.prop(j,"disabled",!1)}})},delItem:function(b){var e=this,f=d.data(b,r),g=f.realName,h=f.id;confirm("\u5220\u9664\u5f53\u524d\u81ea\u5b9a\u4e49\u7684\u7c7b\u76ee\u4e0d\u4f1a\u5f71\u54cd\u60a8\u53d1\u5e03\u7684\u5b9d\u8d1d\n\u60a8\u7684\u5b9d\u8d1d\u8fd8\u662f\u5728\u201c"+e.hostName+"\u201d\u7c7b\u76ee\u4e0b\u9762\u3002\n\n\u786e\u5b9a\u5220\u9664\u5f53\u524d\u81ea\u5b9a\u4e49\u7684\u7c7b\u76ee\u201c"+g+"\u201d\u5417\uff1f")&&a.IO.post(c.api,{type:p,id:h,cid:e.cid,_tb_token_:c.token||""},function(a){a.result?(d.remove(b),e.setFullStatus(),e.fire("delItem",{host:b,id:h})):alert(a.msg)},"json")},sync:function(a){var b,c=d.get(".edit-input",a),e=d.get(".view-input",a),f=d.data(a,s);f?(b=d.val(c),d.text(e,b)):(b=d.text(e),d.val(c,b))},setSelectedItem:function(a){var b,c=this.selectedItem;c&&(d.removeClass(c,l),b=d.data(c,r),b.selected=!1),this.selectedItem=a,a&&(b=d.data(a,r),d.addClass(a,l),b.selected=!0,this.fire("selected",{target:a,data:b}))},setEditMode:function(a,b){d[b?"addClass":"removeClass"](a,m),d.data(a,s,b)},setFullStatus:function(){var a=d.children(this.elList),b=a.length>=g;d[b?"addClass":"removeClass"](this.elListWrap,j),this.fire("flushList")},toggle:function(a){void 0===a&&(a=this.isVisible),a?(this.elWrap||this._initWrap(),d.show(this.elWrap)):d.hide(this.elWrap),this.isVisible=a},show:function(a){(a||this.elWrap)&&this.toggle(!0)},hide:function(){this.toggle(!1)},error:function(a,b){var c=d.data(a,q);b?(c=this._getTip(a),d.text(c.elMsg,b),d.show(c.elWrap)):c&&d.hide(c.elWrap)},_getTip:function(a){var b=d.data(a,q);if(!b){var c=d.create('<div class="msg-error"><i class="icon icon-error"></i> </div>'),e=d.create('<span class="msg"></span>');d.append(e,c),d.append(c,a),b={elWrap:c,elMsg:e},d.data(a,q,b)}return b}}),a.mix(b,{initConfig:function(a){c=a},render:function(c,d,e){var f=new b(c,d,e),g=d.altData;return g||(g=d.altData=[]),f.on("save",function(a){var b=a.data;a.saveType===n&&g.push(b)}),f.on("delItem",function(b){a.each(g,function(a,c){return a.id===b.id?(g.splice(c,1),!1):void 0})}),f}}),b}),KISSY.add("v2/source/category/cateselect",function(a,b,c,d,e,f,g){function h(a,b,c){A&&z||(z=o.get("#J_customId"),A=o.get("#J_customName"));var d={selected:function(b){if(a.selectedItem!=this.host&&a.selectedAltItem!=this){var c=a.getItemData(this.host);a.fire("click",{data:c,altSilent:!0})}a.select(),a.focus(),o.scrollIntoView(this.elWrap,a._wrap),i(a,this);s.model.get("path");s.update({reloadPath:{}});var d=b.data;d&&(o.val(z,d.id),o.val(A,d.name))},delItem:function(b){if(a.selectedAltItem===this&&this.selectedItem===b.host){var c=o.children("#J_OlCascadingList"),d=a.level-1,e=c[d],f=a.getIntance(e);if(e&&f){var g=a.getItemData(f.selectedItem);f.fire("click",{data:g,altSilent:!0})}}}},e=f.render(b,c,d);return e.on("flushList",function(){o.scrollIntoView(this.elWrap,a._wrap)}),o.data(b,r,e),e}function i(a,b){var c=a.selectedAltItem;c&&b!==c&&c.setSelectedItem(),a.selectedAltItem=b,!b&&a.originData&&0===a.originData.type&&(z&&o.val(z,""),A&&o.val(A,""))}window.TB.IC={};var j,k,l,m,n=a.Event,o=a.DOM,p=a.io,q=2,r="data-altname-instance",s=new b("cateSelect"),t="1",u="0",v={getBranchData:function(a){var b,c=a.length,d=[],e=0;if(0!==c){if(b=a[c-1],1===b.type){for(;c-->0;)if(b=a[c],1===b.type)d.unshift(b.sid);else if(0!==b.leaf){e=b.sid;break}}else e=b.sid;return{cateId:e,pv:d.join(";")}}}},w={},x={getCateBaseData:{need:["setUpApi"],run:function(a){var b=this;this.update({loading:1}),p.jsonp(a,"",function(a){b.update({loading:0}),b.update({allowCates:a.AlchlCates,cateDesc:a.CateDesc})})}},writeExpand:{need:["expandData","expandApi"],run:function(a,b){p.post(b,a)}},loadBranch:{need:["loadBranchData","branchApi"],run:function(b,c){var d=this,e=a.param(b);w[e]?d.update({newBranchData:{data:w[e]}}):(this.update({loading:1}),p({type:"post",url:c,data:e,success:function(a){d.update({loading:0}),d.update({newBranchData:{data:a}}),w[e]=a},dataType:"json",error:function(b,c){alert("\u6570\u636e\u8bf7\u6c42\u9519\u8bef\uff01"),a.log(["request error:",c],"error"),d.update({loading:0})},timeout:10}))}}},y={init:{need:["cateIdEl","pvsEl","prevNav","nextNav"],run:function(a,b,c,d){var e=this;this.update({loadBranch:function(a,b,c){e.update({path:[]}),e.update({loadBranchData:{path:c||"all",sid:a,pv:b||""}})}}),this.update({loadBranchData:{path:"all",sid:a.value,pv:b.value}}),this.update({path:[],leftHideNum:0}),n.on(c,"click",function(a){e.update({moveCmd:{num:1}}),a.preventDefault()}),n.on(d,"click",function(a){e.update({moveCmd:{num:-1}}),a.preventDefault()})}},clear:{need:["path","container"],run:function(a,b){for(var c,d=o.query(".cc-list-item",b),e=d.length,f=a.length;e-->f;)c=d[e],c.parentNode.removeChild(c)}},selBranchRender:{need:["newBranchData","container"],run:function(b,c){a.log("selBranch render");var d=this;a.each(b.data,function(a){var b=document.createElement("li");b.className="cc-list-item",c.appendChild(b),d.update(1===o.children(c).length?{addRoot:{wrap:b,cateData:a}}:{addBranch:{wrap:b,cateData:a}})})}},branchChange:{need:["newBranch"],run:function(a){var b=this;a.on("click",function(c){var d=c.data.pathData;c.altSilent||i(a),b.update({pathData:{data:d,idx:this.level}}),l.value===t&&0===d.type?(k.value=u,l.value=u,m.value=t):l.value===u&&(k.value=u,m.value=t);var e;1!==d.leaf?(e=v.getBranchData(b.model.get("path")),b.update({loadBranchData:{path:"next",sid:e.cateId,pv:e.pv}})):b.update({currentBranch:a})}),b.update({currentBranch:a})}},addRoot:{need:["addRoot"],run:function(b){var d=b.wrap,e=b.cateData,f=this,g=new c({wrap:d,label:"\u8f93\u5165\u540d\u79f0/\u62fc\u97f3\u9996\u5b57\u6bcd",level:0});g.level=0,g.on("selected",function(a){var b=a.data,c=a.group;f.update({pathData:{data:b,idx:g.level}}),c&&g.expand(c,!0)}),g.on("itemRender",function(a){var b=a.target;o.attr(b,"role","treeitem")}),g.on("groupRender",function(a){var b=a.group,c=a.list,d=a.data;g.isExpanded(b)&&(d.expanded=!0),g.expand(b,d.expanded),c.setAttribute("role","group"),b.setAttribute("role","treeitem")}),a.each(e.data,function(a,b){g.addGroup(a,e,{content:a.name,expanded:a.expand,id:a.id,isAllowRename:a.isAllowRename,elCls:b===e.data.length-1?"cc-tree-last":""})}),g.on("toggle",function(a){f.update({expandData:{catGroupId:a.data.id,expanded:+!a.expanded}})}),g.render(),this.update({newBranch:g})}},addBranch:{need:["addBranch","container"],run:function(b,c){a.log("addBranch");var e=b.wrap,f=b.cateData,g=this,i=o.children(c).length-1,j=new d({wrap:e,label:"\u8f93\u5165\u540d\u79f0/\u62fc\u97f3\u9996\u5b57\u6bcd",level:i});j.level=i,j.on("selected",function(a){var b=a.data;g.update({pathData:{data:b,idx:j.level}})}),j.on("itemRender",function(b){var c=b.target,d=b.data;o.attr(c,"role","option"),d&&d.isAllowRename&&!function(){o.parent(c)?h(j,c,d.pathData):a.later(arguments.callee,100)}()}),j.on("groupRender",function(a){var b=a.group,c=a.list,d=a.data;c.setAttribute("role","group"),b.setAttribute("role","treeitem"),d.isAllowRename&&o.addClass(b,"altname-wrap")}),a.each(f.data,function(a,b){j.addGroup(a,f,{content:a.name,id:a.id,isAllowRename:a.isAllowRename,elCls:b===f.data.length-1?"cc-group-last":""})}),j.render(),this.update({newBranch:j})}},setPath:{need:"pathData",run:function(a){var b=this.model.get("path");b=b.slice(0,a.idx),b.push(a.data),this.update({path:b});var c=v.getBranchData(b);this.update(c);var d=b[b.length-1];0!==d.leaf?e.request(c):e.clear()}},fixPosition:{need:["currentBranch"],run:function(b){var c,d=this.model.get("leftHideNum"),e=b.level;c=e>=q+d?q+d-e:Math.min(d,q-e+d),a.log(["move",c,d,e]),this.update({moveCmd:{num:c}})}},showPrevNav:{need:["leftHideNum","prevNav"],run:function(a,b){b.style.visibility=a>0?"visible":"hidden"}},showNextNav:{need:["rightHideNum","nextNav"],run:function(a,b){b.style.visibility=a>0?"visible":"hidden"}},move:{need:["moveCmd","container"],run:function(b,c){var d=b.num,e=this.model.get("leftHideNum")||0,f=this.model.get("currentBranch").level;e-=d,this.update({leftHideNum:e,rightHideNum:f-q-e}),a.each(o.children(c),function(b,c){a.log("hidden"),b.style.visibility=e>c||c>q+e?"hidden":""}),0!==d&&(j&&j.stop(!0),j=g(c,{left:(parseInt(c.style.left)||0)+225*d+"px"},.4,"easeNone",function(){j=void 0}),j.run())}},loading:{need:["loading","loadContainer"],run:function(a,b){a?o.addClass(b,"loading"):o.removeClass(b,"loading")}}};s.init=function(){var b=this;k=o.get("#J_BySearch"),l=o.get("#J_ByLateCategory"),m=o.get("#J_ByCategorySystem");var c=Sell.Config.get("altname");f.initConfig(c),this.getData(".J_ModCateSelectData"),this.update({loadContainer:a.get("#main .cate-container"),container:a.get("#J_OlCascadingList"),cateIdEl:a.get("#J_IptCateID"),pvsEl:a.get("#J_IptPropID"),prevNav:a.get("#J_LinkPrev"),nextNav:a.get("#J_LinkNext"),reloadPath:{}}),a.each(a.merge(x,y),function(a){b.use(a)})};var z,A;return s},{requires:["../mvc","./tree","./combobox","./previewguid","./altname","anim"]}),KISSY.add("v2/source/category/catepath",function(a,b){function c(a){return a.replace(/[\u4e00-\u9fa5]/gi,"**").length}function d(a){for(var b=0,c=0,d=0;d<a.length;d++)if(a.charCodeAt(d)>255?c+=2:c++,c>g){b=d;break}return a.substring(0,b)}var e=(a.Event,a.DOM,a.io,new b("catePath")),f={},g=126,h={path:{need:["cateSelect:path","pathBox","cateSelect:reloadPath"],run:function(b,c){var d,e=b.length,f=0,g="",h="";if(e){for(;e>f;)d=b[f++],h=d.name,d.altData&&a.each(d.altData,function(a){return a.selected?(h=a.name,!1):void 0}),g+="<li>"+(1===f?"":"&nbsp;&gt;&nbsp;")+h+"</li>";1!==d.leaf&&(g+="<li>&nbsp;&gt;&nbsp;...</li>")}else g+="<li>\u65e0</li>";c.innerHTML=g}},desc:{need:["cateSelect:pathData","cateSelect:cateDesc","descBox"],run:function(b,e,f){var h=e.data[b.data.sid];!h&&b.data&&b.data.spuMemo&&(h=b.data.spuMemo),a.log(["show desc",h]),h?(c(h)>g&&(f.title=h,h=d(h,g)+"..."),f.style.display="block",f.innerHTML=h):(f.style.display="none",f.title="")}}};return e.init=function(){a.log("catePath-init");var b=this;this.update({pathBox:a.get("#J_OlCatePath"),descBox:a.get("#J_EmCateDesc")}),a.each(a.merge(f,h),function(a){b.use(a)})},e},{requires:["../mvc"]}),KISSY.add("v2/source/localstorage",function(a){function b(){f=localStorage,g=function(a,b){f.setItem(a,b)},h=function(a){return f.getItem(a)},i=function(a){f.removeItem(a)}}function c(){var a="IELocalDataStore",b=document;f=b.createElement("input"),f.type="hidden",b.body.appendChild(f),f.addBehavior("#default#userData"),g=function(b,c){try{f.setAttribute(b,c),f.save(a)}catch(d){}},h=function(b){try{return f.load(a),f.getAttribute(b)}catch(c){}},i=function(b){try{f.removeAttribute(b),f.save(a)}catch(c){}}}function d(){"undefined"!=typeof localStorage?b():a.UA.ie<8&&c(),j=!0}function e(){j||d()}var f,g,h,i,j=!1;return{setItem:function(a,b){return e(),g(a,b)},getItem:function(a){return e(),h(a)},removeItem:function(a){return e(),i(a)}}}),KISSY.add("v2/source/category/catesearch",function(a,b,c,d){function e(){return{}}function f(){D!==r&&(v.value=E,w.value=F,x.value=F,q.val(y,D),q.show(B),q.hide(q.get(".cate-path")),g(),n(!0),u.update({submitStatus:{buttonable:!1,linkable:!1,isBookCate:!1}}))}function g(){var b=cfg.apiSearch,c=encodeURIComponent;D!==r&&a.ajax({url:b,type:"POST",dataType:"json",data:{keyword:c(D)},success:function(a){n(!1),o(a)},error:function(){alert("\u8bf7\u6c42\u6570\u636e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff01")}})}function h(){var a=q.get(".cate-path");q.hide(B),q.show(a)}function i(a,b){var c,d,f=!1,g="selected";c=1*q.attr(a,"data-issued"),d=1*q.attr(a,"data-bookcate"),q.removeClass(b.heightlight,g),q.addClass(a,g),b.heightlight=a,b.selected=f&&!c||!f?a:void 0,u.update({submitStatus:{buttonable:f?!c:!0,linkable:!!c,isBookCate:!!d},updateFormDataGuid:e()})}function j(){"true"==c.getItem(t);p.on(elInput,"focus",function(){q.hide(z)}),p.on(elInput,"blur",function(){var a=elInput.value;D=a,0===a.length&&q.show(z)}),p.on(elInput,"keydown",function(a){if(13===a.keyCode){var b=elInput.value;a.preventDefault(),D=b,f()}}),elInput.value!==r&&q.hide(z);try{elInput.focus()}catch(a){}}function k(){p.on(A,"click",function(a){a.preventDefault(),f()})}function l(){var a=q.get(".J_TriggerExit",B),b=q.query(".J_FlexTrigger",B);elCount=q.get(".J_RecordCount",B),C=q.get("ol",B),m(),p.on(b,"click",function(a){a.preventDefault();var b=a.currentTarget,c=q.parent(b),d=q.hasClass(b,"trigger-expand")?"addClass":"removeClass";q[d](c,"expand")}),p.on(a,"click",function(a){a.preventDefault(),u.update({expandGuid:e()}),h()})}function m(){var a=this;p.delegate(C,"click","li",function(b){var c=b.target,d=c.tagName;("EM"===d||"SPAN"===d)&&(c=q.parent(c,"li")),"LI"!==c.tagName||q.hasClass(c,"empty-msg")||i(c,G,a)}),p.delegate(C,"dblclick","li",function(a){var b=a.target,c=b.tagName;("EM"===c||"SPAN"===c)&&(b=q.parent(b,"li")),"LI"!==b.tagName||q.hasClass(b,"empty-msg")||(G.selected=b,u.update("jumpGuid",e()))})}function n(a){var b=a?"addClass":"removeClass",c=q.parent(B,".cate-container");q[b](c,"loading")}function o(b){var c=b.data,d=q.parent(C),e="<em> &gt;&gt; </em>",f='<li class="empty-msg">\u62b1\u6b49\uff0c\u6ca1\u6709\u627e\u5230\u4e0e\u5173\u952e\u5b57\u201c'+a.escapeHTML(D)+"\u201d\u76f8\u5173\u7684\u7c7b\u76ee\u3002</li>",g=[];0===c.length?(q.addClass(d,"no-result"),g.push(f)):q.removeClass(d,"no-result"),c.length>10?q.addClass(d,"flex-display"):q.removeClass(d,"flex-display"),a.each(c,function(b,c){var d=c>=s?"hidden":r,f={idx:c+1,path:b.path.join(e),sid:b.sid,cls:d,count:b.count,issued:b.withKeyProperties,isBookCate:b.isBookCat},h=a.substitute(H.record,f);g.push(h)}),C.innerHTML=g.join(r),elCount.innerHTML=c.length;var h=q.get("li",C);i(h,G,this)}var p=a.Event,q=a.DOM,r="",s=10,t="sell.category.hidehint",u=new b("search");Logics={expandCategory:{need:["cateSelect:loadBranch","expandGuid"],run:function(a){var b;G.heightlight&&(b=G.heightlight.getAttribute("data-sid"),a(b))}},JumpTo:{need:["cateForm:submit","jumpGuid"],run:function(a){var b=G.selected.getAttribute("data-sid");a({cateId:b})}},disabledStatus:{need:["cateForm:fnDisableSubmitElems","cateForm:fnSwitchSubmitLink","submitStatus"],run:function(a,b,c){a(c.buttonable,c.linkable),b(c.isBookCate)}},updateFormData:{need:["cateForm:cateIdOpt","updateFormDataGuid"],run:function(a){var b=r,c=G.selected;c&&(b=q.attr(c,"data-sid")),a.value=b,d.request({cateId:b,pv:r})}}};var v,w,x,y,z,A,B,C,D,E="1",F="0",G={},H={searchHint:'<div id="J_SearchHint" class="search-hint" style="display:none;"><i></i><p class="J_HintMsg">{msg}</p><a href="javascript:void();">\u4e0d\u518d\u663e\u793a</a></div>',record:'<li class="{cls}" data-sid="{sid}" data-issued="{issued}" data-bookcate={isBookCate}><span class="lidx">{idx}.</span>{path}</li>'};return{init:function(){cfg=Sell.Config.get("search"),elInput=a.get("#J_SearchKeyWord"),elInput&&cfg&&(v=q.get("#J_BySearch"),w=q.get("#J_ByLateCategory"),x=q.get("#J_ByCategorySystem"),y=q.get("#J_SearchKey"),z=a.get("#J_SearchHolder"),A=a.get("#J_SearchButton"),B=a.get("#J_SearchResult"),G={},j(),k(),l(),a.each(Logics,function(a){u.use(a)}),u.update({fnHideResult:function(){h()}}))}}},{requires:["../mvc","../localstorage","./previewguid"]}),KISSY.add("v2/source/category/lastused",function(a,b,c){function d(a){var b=a.target,c=b.get("value");f.value=m,g.value=l,h.value=m,k.update("itemSelectedValue",c)}function e(a){var b=a.target,c=b.value;k.update("itemSelectedValue",c)}var f,g,h,i=a.Event,j=a.DOM,k=new b("cateLastUsed"),l="1",m="0",n={itemSelected:{need:["itemSelectedValue","cateSelect:loadBranch"],run:function(b,c){this.update("hideSearchGuid",{});try{c(b)}catch(d){a.log("undefined method: loadBranch")}}},hideSearch:{need:["search:fnHideResult","hideSearchGuid"],run:function(a){a()}}},o={initSelect:{need:["elSelect"],run:function(a){var b=j.width(a),f=c.Select.decorate(a,{prefixCls:"used-",menuCfg:{width:b+34}}),g=j.get(".used-menu-button-caption",f.get("contentEl"));j.width(g,391),f.on("click",d),i.on(a,"change",e)}}};return k.init=function(){var b=this,c=a.get("#J_CateLastUsed");c&&(f=j.get("#J_BySearch"),g=j.get("#J_ByLateCategory"),h=j.get("#J_ByCategorySystem"),b.update({elSelect:c}),a.each(a.mix(n,o),function(a){b.use(a)
}))},k},{requires:["../mvc","menubutton"]}),KISSY.add("v2/source/category/cateform",function(a,b,c){var d=a.Event,e=a.DOM,f=(a.io,a.Node.all),g=new b("cateForm"),h={},i={sync:{need:["cateSelect:cateId"],run:function(a){this.update({cateId:a})}}},j={formEvent:{need:["form"],run:function(a){var b=this;d.on(a,"submit",function(a){a.preventDefault(),b.update("submitGuid",{})})}},submitBtn:{need:["cateSelect:path","subBtn"],run:function(b){var c=b[b.length-1];a.log(["subbtn switch",c]),c&&1===c.submit?this.update("disableBtnSubmit",!0):!c||1!==c.type&&0===c.leaf?this.update("disableBtnSubmit",!0):this.update("disableBtnSubmit",!1)}},disableBtnSubmit:{need:["subBtn","disableBtnSubmit"],run:function(a,b){var c=b?"addClass":"removeClass";e[c](a.parentNode,"cateBtn-disabled"),a.disabled=b}},disableLinkSubmit:{need:["subLink","subLinkAble"],run:function(a,b){var c=b?"removeClass":"addClass";e[c](a,"disabled")}},linkSwitch:{need:["cateSelect:path","bookLimitData"],run:function(b,c){var d,e=b.length,f=b[e-1];if(d=f&&1===f.spuEnable?!1:f&&(1===f.type||2===f.leaf),1===e){var g=f&&f.spell===c.cate;this.update("isBookCate",g)}else 2===e&&b[0].spell===c.cate&&d&&(d=-1===a.indexOf(f.spell,c.data));a.log("update linkable"),this.update({subLinkAble:d})}},showTemplateLinkOrBookLink:{need:["bookOperateWrap","templateLink","isBookCate"],run:function(a,b,c){c?(e.removeClass(a,"hidden"),e.addClass(b,"hidden")):(e.addClass(a,"hidden"),e.removeClass(b,"hidden"))}},itemTemplateEvent:{need:["subLink","cateIdOpt"],run:function(a,b){var c=this;d.on(a,"click",function(a){if(a.preventDefault(),c.model.get("subLinkAble")){var d=a.target;if("A"===d.tagName){var e=b.value;window.location=d.href+(-1===d.href.indexOf("?")?"?":"&")+"cat_id="+e}}})}},submitByPath:{need:["cateSelect:cateId","cateSelect:pv"],run:function(a,b){this.update({submitData:{cateId:a,pvStr:b}})}},submitData:{need:["submitData","cateIdOpt","pvOpt"],run:function(a,b,c){a.cateId&&(b.value=a.cateId||""),a.pvStr&&(c.value=a.pvStr||"")}},doSubmit:{need:["form","submitGuid"],run:function(b){var d=this;if(h&&h.api){var e=f("#J_IptCateID").val(),g=f("#J_fenxiaoProduct").val();return void a.ajax({url:h.api,dataType:"jsonp",data:{catId:e,fenxiaoProduct:g||""},success:function(a){if(a.passed===!1){var e=['<div class="tbs-dialog"><div class="tbs-dialog-head">\u63d0\u793a</div>','<div class="tbs-dialog-body">'+a.message+"</div>",'<div class="tbs-dialog-foot"></div>',"</div>"].join(""),f=new c({prefixCls:"tbs-",elCls:"tbs-dialog-popup cateform-dialog",content:e,mask:!0,closable:!0,closeAction:"destroy",zIndex:2e3,align:{points:["cc","cc"]}});f.show(),d.update("disableBtnSubmit",!0)}else b.submit()},error:function(){b.submit()}})}b.submit()}}};return g.init=function(){var b=this;h=Sell.Config.get("checkLimit"),this.getData(".J_ModCateFormCfg"),b.update({subBtn:a.get("#J_CatePubBtn"),subLink:a.get("#J_PubLinkWrap"),templateLink:a.get("#J_CatePubLink"),form:a.get("#J_FrmCateFilter"),cateIdOpt:a.get("#J_IptCateID"),pvOpt:a.get("#J_IptPropID"),bookOperateWrap:a.get("#J_OperateBook"),bookOperateItems:a.query("#J_OperateBook a"),subLinkAble:!1,bookLimitData:{cate:"sj zz bz",data:["qkzz","bz","pxkc","bkdy","hk nl qtysp","dy5yzq"]},fnDisableSubmitElems:function(a,c){b.update({subLinkAble:c,disableBtnSubmit:!a})},fnSwitchSubmitLink:function(a){b.update("isBookCate",a)}}),this.update({submit:function(a){b.update({submitData:a}),b.update("submitGuid",{})}}),a.each(a.merge(i,j),function(a){b.use(a)})},g},{requires:["../mvc","overlay"]}),KISSY.add("v2/source/category/makepoint",function(a){var b=a.Node.all;return{init:function(){this.regEvent()},options:{config:{search:"mjzx.686.1",close:"mjzx.686.2",searchResponse:"mjzx.686.5.",timespans:"mjzx.50.2",history:"mjzx.52.1",category:"mjzx.52.2"}},regEvent:function(){var a=this,c=this.options.config,d=(new Date).getTime();b("#J_SearchButton").on("click",function(){var d=b("#J_SearchKeyWord").val();a.track(c.search,{searchtext:d})}),b("#J_SearchKeyWord").on("keyup",function(d){var e;13===d.keyCode&&(e=b("#J_SearchKeyWord").val(),a.track(c.search,{searchtext:e}))}),b(".J_TriggerExit").on("click",function(){var d=b("#J_SearchKeyWord").val();a.track(c.close,{searchtext:d})}),b("#J_CatePubBtn").on("click",function(){var e,f,g=b("#J_SearchResult"),h=g.all(".selected"),i=b("#J_SearchKeyWord").val(),j=b("#J_IptCateID").val(),k=b(".cc-selected"),h=k.item(k.length-1),l=b(".used-menu-button-caption").text(),m="\u8bf7\u9009\u62e9"===l?!1:!0,f=h.text(),n=(new Date).getTime(),o=n-d;"none"!==g.css("display")?(f=h.text(),e=h.all("span.lidx").text(),e=e?e.replace(/\./g,""):""):m?a.track(c.history,{selecttext:f}):a.track(c.category,{selecttext:f}),e&&a.track(c.searchResponse+e,{searchtext:i,selecttext:f}),a.track(c.timespans,{catid:j,timespans:o})}),b("#J_SearchResult").delegate("dblclick","li",function(){var e,f,g=b("#J_SearchResult"),h=g.all(".selected"),i=b("#J_SearchKeyWord").val(),j=b("#J_IptCateID").val(),k=(new Date).getTime(),l=k-d;"none"!==g.css("display")&&(f=h.text(),e=h.all("span.lidx").text(),e=e?e.replace(/\./g,""):""),e&&a.track(c.searchResponse+e,{searchtext:i,selecttext:f}),a.track(c.timespans,{catid:j,timespans:l})})},track:function(b,c){var d,e,f;b&&(d=a.merge(c,{cache:a.now()}),e="//gm.mmstat.com/"+b+"?"+a.param(d),f=new Image,f.src=e)}}}),KISSY.add("v2/category/main",function(a){var b=a.makeArray(arguments);a.ready(function(){for(var a=1;a<b.length;a++){var c=b[a]||{};c.init&&c.init()}})},{requires:["v2/source/atpanel","v2/source/category/protocol","v2/source/category/catetype","v2/source/category/cateselect","v2/source/category/catepath","v2/source/category/catesearch","v2/source/category/lastused","v2/source/category/cateform","v2/source/category/makepoint"]});