

KISSY.add("v2/source/service/treelayer",function(c,t,s){var o,a,r,n,l=c.DOM,u=c.Event,i=280;function d(e,t){if(t&&(!t.items||0!==t.items.length))for(var n=0,i=t.items.length;n<i;n++){var o=t.items[n];if(!o)return;var a=o.items&&0<o.items.length,r=(c.now(),new s.Node({content:o.text,expanded:!1,isLeaf:!a,tree:e}));a&&(r.subData=o),r.set("valueId",o.value),e.addChild(r)}}function f(){var e=f.timer;e&&e.cancel(),f.timer=c.later(function(){var e=a.get("contentEl"),t=o.get("el").height();l.height(e,"auto"),i<t&&l.height(e,i)},100)}function v(o){o.on("afterRenderUI",function(){var e=o.get("children");c.each(e,function(e){if(!e.subData){var t=e.get("el");l.addClass(t,"alone-item")}})}),o.on("expand",function(e){var t=e.target,n=t.subData;n&&(delete t.subData,d(t,n))}),o.on("collapse expand",function(e){f()}),o.on("click",function(e){var t=e.target,n=t.get("content"),i=t.get("valueId");o.fire("select",{selectedItem:t,text:c.unEscapeHTML(n),value:i}),a.hide()}),o.on("select",function(e){l.val(n,e.text);var t=o.get("selectedItem");t&&t.set("selected",!!e.selectedItem)}),o.on("defaultSelect",function(e){var t=c.unEscapeHTML(e.text);n.defaultValue=t,o.fire("select",{text:t,value:e.value})}),6===c.UA.ie&&o.on("afterRenderUI",function(){!function t(e){var n=e.get("el"),i=e.get("children");u.on(n.one(".ks-tree-row"),"mouseenter mouseleave",function(e){var t="mouseenter"==e.type?"addClass":"removeClass";l[t](e.currentTarget,"ks-tree-row-hover")});if(!i||0===i.length)return;c.each(i,function(e){t(e)})}(o)})}function g(e){e?l.addClass(r,"sim-loading"):l.removeClass(r,"sim-loading")}return{render:function(e,i){return o&&a||(r=l.create('<div class="sim-select" id="simselect"><input type="text" class="sim-select-input" readonly="readonly" /><div class="sim-select-icon"></div></div>'),n=l.get(".sim-select-input",r),a=new t.Popup({trigger:r,triggerType:"click",elCls:"sim-select-list",align:{node:r,points:["bl","tl"]}}),o=new s({content:"\u5e97\u94fa\u5206\u7c7b",expanded:!0,showRootNode:!1}),u.on(window,"resize",function(){a.set("align",{node:r,points:["bl","tl"]})}),a.on("afterRenderUI",function(){var t=a.get("contentEl"),n=a.get("el");l.unselectable(n),u.on(document,"click",function(e){var t=e.target;l.contains(n[0],t)||l.contains(r,t)||a.hide()}),g(!0),c.io({url:i.api,cache:!1,dataType:"json",success:function(e){g(!1),d(o,e),o.set("render",t),o.render()}})}),v(o),l.append(r,e),l.addClass(e,"rendered")),{tree:o,layer:a}}}},{requires:["overlay","tree"]}),KISSY.add("v2/source/service/searcharea",function(o,s){var l=o.DOM,u=o.Event;return{init:function(){var n=this,e=l.get(".search-form"),t=l.get(".aslink",e);this.renderTreeLayer(t),t&&this.renderForm(t,e);var i=l.get("#J_RecommendTrigger");i&&o.use("overlay",function(e,t){n.bindRecommend(i,t)})},bindRecommend:function(e,t){var n=new t({elCls:"recommend-dialog",content:l.html(l.get("#J_RecommendDetail")),align:{node:window,points:["tc","tc"],offset:[-10,20]},mask:!0,closable:!0,zIndex:999999}),i=l.get("#J_RecommendTrigger");if(i){n.on("show",function(){this.set("align",{node:window,points:["tc","tc"],offset:[-10,20]})}),u.on(i,"click",function(){n.show()})}},renderForm:function(e,t){var n=l.filter("input,select",function(e){var t=e.tagName.toLowerCase();return o.inArray(t,["select","input"])},t);u.on(e,"click",function(e){e.preventDefault(),o.each(n,function(e){var t,n,i,o=e.tagName.toLowerCase();if("input"==o)switch(e.type){case"text":l.hasClass(e,"sim-select-input")||(i=e,l.val(i,""));break;case"checkbox":n=e,l.prop(n,"checked",!1)}else"select"===o&&"J_HideCateIdInShop"!==e.id&&(((t=e).options&&t.options[0]).selected=!0)})})},renderTreeLayer:function(e){var t=l.get("#J_ItemSort");if(t){var i=l.get("#J_HideCateIdInShop"),o=l.get("#J_HideCateNameInShop"),n={api:l.attr(i,"data-url")},a=s.render(t,n).tree,r=i.options[0],c={text:l.text(r),value:l.val(r),selected:!0};a.on("select",function(e){try{i.options.length=0}catch(e){}var t=e.text,n=new Option(t,e.value,!0,!0);i.appendChild(n),l.val(o,t)}),u.on(e,"click",function(e){a.fire("select",{text:"\u5168\u90e8\u5206\u7c7b",value:""})}),a.fire("defaultSelect",c)}}}},{requires:["./treelayer"]}),KISSY.add("v2/source/service/lessquantity",function(o){var a,n=o.DOM,i=o.Event,r='<div class="less-tip"><i class="icon icon-tip"></i>\u60a8\u7684\u5b9d\u8d1d\u662f<a href="//service.taobao.com/support/knowledge-5425552.htm" target="_blank">\u4ed8\u6b3e\u51cf\u5e93\u5b58<i class="icon icon-help-s"></i></a>\uff0c\u8bf7\u5230<a href="{url}" target="_blank">\u7f16\u8f91\u9875\u9762</a>\u4fee\u6539\u5e93\u5b58\u3002</div>';function c(){if(!a)return!1;var e=new a;return c=function(){return e},e}function s(e,t){var n=c();n.set("align",{node:e,points:["tl","bl"],offset:[-100,-8]}),n.set("content",o.substitute(r,{url:t})),n.show()}function l(n,i){o.use("overlay",function(e,t){a=t,(l=s)(n,i)})}return{init:function(){var e=n.get("#J_DataTable"),t=n.query("div.J_LessQuantity",e);t&&0!==t.length&&(i.on(t,"click",function(e){e.halt();var t=e.currentTarget;l(t,n.attr(t,"data-url"))}),i.on(window,"resize",function(){var e=c();e&&e.set("align",o.clone(e.get("align")))}))}}}),KISSY.add("v2/source/service/itemoperator",function(i,o){var a=i.DOM,t=i.Event;function r(){if(!o)return!1;var t=new o({prefixCls:"sale-",elCls:"itemtip-layer"});return t.on("afterRenderUI",function(e){t.get("el").append(a.create('<div class="arrow arrow-right"><i class="outer"></i><i class="inner"></i></div>'))}),r=function(){return t},t}function c(e){var t=r(),n=a.attr(e,"data-hint")||a.attr(e,"title");n&&(t.set("align",{node:e,points:["tl","tr"],offset:[10,-8]}),t.set("content",n),t.show())}function s(n){i.use("overlay",function(e,t){o=t,(s=c)(n)})}function n(){var e=r();e&&e.hide()}return{init:function(){var e=a.query("div.J_ChangeCate");t.on(e,"mouseenter",function(e){e.halt(),s(e.currentTarget)}),t.on(window,"resize",function(e){n()}),t.on(e,"mouseleave",function(e){e.halt(),n()})},bindHover:function(){var e=a.query("div.J_Pandbox"),n=null;t.on(e,"mouseenter",function(e){e.halt();var t=e.currentTarget;n&&n.cancel(),a.addClass(t,"pand-hover")}),t.on(e,"mouseleave",function(e){var t=e.currentTarget;n=i.later(function(){a.removeClass(t,"pand-hover"),n=null},300)})}}}),KISSY.add("v2/source/service/itemsmanager",function(c){var s=c.DOM,t=c.Event;function i(e,t){var n,i,o,a=(l[t]||{}).filter,r=s.attr(e,"data-id")||(n=a,i=s.query(".selector","#J_DataTable"),o=[],c.each(i,function(e){var t=s.val(e);if(s.prop(e,"checked")){if(n&&!n(e,t))return;o.push(t)}}),o);return c.makeArray(r)}var l={vip:{unselect:function(){alert("\u8bf7\u9009\u4e2d\u8981\u8bbe\u7f6e\u4e3aVIP\u7684\u5b9d\u8d1d\uff01")},submit:function(e){var t=function(e,t){if(!e)return"";var n=-1!=e.indexOf("?")?"&":"?";return e+n+c.param(t)}(s.attr(e.trigger,"data-url"),{itemIds:e.items.join(",")});t&&window.open(t)}}};return{init:function(){var e=s.get(".J_ItemsManager");t.on(e,"click",function(e){e.preventDefault();var t=e.currentTarget,n=s.attr(t,"data-type");!function(e,t){var n=l[e],i=n.unselect;if(!t.items||0==t.items.length)return i&&i.call(n);n.submit(t)}(n,{trigger:t,items:i(t,n)})})}}}),KISSY.add("v2/source/localstorage",function(t){var i,o,a,r,c=!1;function e(){var n,e;"undefined"!=typeof localStorage?(i=localStorage,o=function(e,t){i.setItem(e,t)},a=function(e){return i.getItem(e)},r=function(e){i.removeItem(e)}):t.UA.ie<8&&(n="IELocalDataStore",e=document,(i=e.createElement("input")).type="hidden",e.body.appendChild(i),i.addBehavior("#default#userData"),o=function(e,t){try{i.setAttribute(e,t),i.save(n)}catch(e){}},a=function(e){try{return i.load(n),i.getAttribute(e)}catch(e){}},r=function(e){try{i.removeAttribute(e),i.save(n)}catch(e){}}),c=!0}function n(){c||e()}return{setItem:function(e,t){return n(),o(e,t)},getItem:function(e){return n(),a(e)},removeItem:function(e){return n(),r(e)}}}),KISSY.add("v2/source/service/qrcode",function(u,e,t){var d=u.DOM,n=u.Event;var f=null;function i(){f&&f.cancel(),f=u.later(function(){var e=v();e&&e.hide(),f=null},300)}function v(){var n=new t({prefixCls:"hint-",elCls:"qrcode-layer hint-default"});return n.on("afterRenderUI",function(e){var t=n.get("el");t.append(d.create('<div class="arrow arrow-left"><i class="outer"></i><i class="inner"></i></div>')),t.on("mouseenter",function(){f&&f.cancel()}),t.on("mouseleave",function(){i()})}),v=function(){return n},n}function g(e){var t=v()||{},n=t.get("align");t&&(e||n)&&(t.set("align",{node:e||n&&n.node,points:["cr","tl"],offset:[10,-20]}),t.show())}return{init:function(){var s=Sell.Config.get("QRCode");if(s){var e=d.query(".J_QRCode"),l=null;n.on(e,"mouseenter",function(e){var t,n,i,o,a,r=e.currentTarget,c=d.attr(r,"data-param");f&&f.cancel(),l!=c?(t=s.getQRUrl,n=c,i=r,o=v(),a=t+(0<=t.indexOf("?")?"&":"?")+n,o.set("content",u.substitute('<div class="link-bar"><a class="download-link" href="{image}&download=true" target="_blank">\u4e0b\u8f7d\u6807\u7b7e</a></div><img src="{image}" width="200" height="200" alt="\u4e8c\u7ef4\u7801" />',{image:a})),g(i),l=c):g(r)}),n.on(e,"mouseleave",function(e){i()})}}}},{requires:["v2/source/localstorage","overlay"]}),KISSY.add("v2/source/service/recommend",function(s){var l=s.DOM,i=s.Event;return{init:function(){var r=Sell.Config.get("recommend"),n=l.get("#J_RecommendSetting"),c=r&&r.url;if(r&&n){var t=l.get(".J_PopButton");l.get(".pop-wrap",t);i.on(t,"mouseenter mouseleave",function(e){"mouseenter"===e.type?l.addClass(t,"wrap-hover"):l.removeClass(t,"wrap-hover")}),s.use("overlay",function(e,t){var a=new t.Dialog({width:380,prefixCls:"hint-",elCls:"hint-layer hint-recommendsetting",headerContent:"\u6a71\u7a97\u8bbe\u7f6e",bodyContent:'<div class="msg-block"><div class="msg-attention"><i class="icon icon-attention"></i>\u6279\u91cf\u8bbe\u7f6e\u6a71\u7a97\u63a8\u8350\u540e\uff0c\u5c06\u4f1a\u8986\u76d6\u60a8\u539f\u6765\u63a8\u8350\u7684\u5b9d\u8d1d\u3002</div></div><label for="">\u5b9d\u8d1d\u63a8\u8350\u987a\u5e8f\uff1a</label><select name="recommendorder" id="J_RecommendOrder"><option value="">--</option></select>',footerContent:'<button type="button" class="btn btn-primary"><p class="btn-txt">\u786e\u5b9a</p></button><a class="btn-cancel" href="#">\u53d6\u6d88</a>'});a.on("afterRenderUI",function(e){var t=a.get("body"),n=a.get("footer"),o=t.one("#J_RecommendOrder")[0],i=n.one(".btn-primary");n.one(".btn-cancel").on("click",function(e){e.halt(),a.hide()}),i.on("click",function(e){var t,n,i;e.halt(),t=o,n=c,""!=(i=l.val(t))?s.io({url:n,dataType:"json",type:"post",data:{order:i},success:function(e){e.result?location.reload():alert(e.msg)},error:function(){alert("\u6a71\u7a97\u8bbe\u7f6e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}}):alert("\u8bf7\u9009\u62e9\u63a8\u8350\u987a\u5e8f")}),o&&r.options&&s.each(r.options,function(e){var t=new Option(e.text,e.value,!1,!1);o.options.add(t)})}),i.on(n,"click",function(e){e.halt(),a.set("align",{points:["cc","cc"]}),a.show()})})}}}}),KISSY.add("v2/source/calendar",function(c,s){var l=c.DOM,u=c.Event,d={id:"singleCalendar",dateFormat:"yyyy-mm-dd",timeFormat:"yyyy-mm-dd HH:MM:ss"};function f(e){e.con.css("display","none"),e.hide()}return{init:function(e){e&&0!==e.length&&c.each(e,function(e){var t=e.targets;delete e.targets;var n,i,o,a,r=(n=e,i=c.merge(d,n),o=c.all('<div id="'+i.id+'" style="z-index:999910;visibility:hidden; left:0;top:0;position:absolute;"></div>').appendTo(document.body),a=new s(o,{triggerType:["click"]}).on("select",function(e){if(!this.showTime){var t=this.currentTrigger;t.value=c.Date.format(e.date,i.dateFormat),u.fire(t,"valuechange"),f(a)}}).on("timeSelect",function(e){var t=this.currentTrigger;t.value=c.Date.format(e.date,i.timeFormat),u.fire(t,"valuechange"),f(a)}),u.on(document,"click",function(e){var t,n,i=e.target;"hidden"==a.con.css("visibility")||a.currentTrigger==i||a.con[0]==i||l.contains(o,i)||(!a.con.contains(i)||"option"!==i[0].nodeName.toLowerCase()&&"select"!==i[0].nodeName.toLowerCase())&&(t=[e.pageX,e.pageY],n=[{x:a.con.offset().left,y:a.con.offset().top},{x:a.con.offset().left+a.con.width(),y:a.con.offset().top+a.con.height()}],t[0]>n[0].x&&t[0]<n[1].x&&t[1]>n[0].y&&t[1]<n[1].y||f(a))}),a);c.each(t,function(n){var e=l.query(n.elements),t=n.triggerTypes||["click"];u.on(e,t[0],function(e){var t=e.currentTarget;l.prop(t,"disabled")||l.prop(t,"readonly")||(r.render({showTime:"time"==n.type}),function(e,t){e.con.css("display","block");var n=l.offset(t);n.top+=l.outerHeight(t),e.currentTrigger=t,e.con.offset(n).css("visibility","visible")}(r,t))}),t[1]&&u.on(input,t[1],function(e){f(r)})})})}}},{requires:["calendar"]}),KISSY.add("v2/source/service/page",function(e,t,n){var o=e.all,i=e.IO;return e.ready(function(){var i=t.get(".enter-trash");if(i){13785696e5<e.now()||e.use("overlay",function(e,t){var n=new t({prefixCls:"hint-",elCls:"hint-guide hint-trashguide",content:"\u70b9\u51fb\u6b64\u5904\uff0c\u627e\u56de\u5df2\u5220\u9664\u7684\u5b9d\u8d1d\uff01",closable:!0,width:260,align:{node:i,points:["tr","br"],offset:[-20,-10]}});n.on("afterRenderUI",function(e){n.get("el").append('<div class="arrow arrow-down"><i class="outer"></i><i class="inner"></i></div>')}),n.show()})}}),e.ready(function(){n.init([{targets:[{elements:".J_CalendarDate",type:"date"},{elements:".J_CalendarTime",type:"time"}]}])}),{init:function(){var e=Sell.Config.get("chiSeller");e&&e.url&&new i({url:window.location.protocol+e.url,type:"get",dataType:"jsonp",success:function(e){if(e&&e.success){var t,n=o("#hd-tip"),i=['<div class="box bulletin">','<div class="hd"><b class="bulb-icon"></b><span class="title">\u63a8\u5e7f</span></div>','<div class="bd">',"<ul>","<li>"+e.content+' <a href="'+e.url+'" target="_blank">'+e.urlTitle+'</a><b class="close-icon">x</b></li>',"</ul>","</div>","</div>"];1===n.length?(i.unshift('<div class="separator"></div>'),t=o(i.join("")),n.after(t)):(t=o(i.join("")),o("#main-content").prepend(t)),t.all(".close-icon").on("click",function(){t.hide()})}}})}}},{requires:["dom","../calendar"]}),KISSY.add("v2/source/service/mobileDesc",function(e,t){var a=e.all,n=null,i=new t({prefixCls:"hint-",elCls:"mobile-desc hint-default hint-overlay",mask:!1,closable:!1,closeAction:"destroy"});function r(e,t){i.set("content",e),i.set("align",{node:t,points:["cr","cl"],offset:[10,0]});var n=i.get("el").one(".mobile-close");n&&n.on("click",function(){i.hide()}),i.show()}function o(){n=setTimeout(function(){i.hide(),n=null},300)}function c(e){e.on("mouseover",function(){n&&(clearTimeout(n),n=null);var e=a(this).attr("alt"),t=a(this).attr("data-link");t&&(e+='&nbsp;<a href="'+t+'" target="_blank">&gt;&gt;\u7acb\u523b\u7f16\u8f91</a>'),r(e,a(this))}),e.on("mouseout",o)}return{init:function(){Sell.Config.get("MobileDesc")&&(i.on("afterRenderUI",function(){var e=a(".j_MobileNoEdit"),t=a(".j_MobileHasEdit");i.get("el").append(a('<div class="arrow arrow-left"><i class="outer"></i><i class="inner"></i></div>')),i.get("el").on("mouseover",function(){n&&(clearTimeout(n),n=null)}),i.get("el").on("mouseout",function(){i.get("el").one(".noedit-firest")||o()}),e.length&&(c(e),e.each(function(e,t){if(a(e).parent(".mobile-noedit-first")){var n=a(this).attr("data-link")||"",i="";n&&(i+='&nbsp;<a href="'+n+'" target="_blank">&gt;&gt;\u7acb\u523b\u7f16\u8f91</a>');var o='<div class="noedit-firest"> '+a(e).attr("alt")+i+'<a class="mobile-close"></a></div>';a(e).on("mouseover",function(){r(o,a(e))})}})),t.length&&c(t)}),i.render())}}},{requires:["overlay"]}),KISSY.add("v2/source/service/weituan",function(e,n){var i=e.all;return{init:function(){if(i(".J_WeiTuan").length){var t=new n({prefixCls:"hint-",elCls:"weituan hint-default hint-overlay",content:'\u8bbe\u7f6e\u5fae\u56e2\uff0c\u8ba9\u8001\u5ba2\u6237\u5e2e\u4f60\u62c9\u65b0\u5ba2\u6237<a class="close"></a>',align:{node:i(".J_WeiTuan")[0],points:["cl","cr"],offset:[-10,0]},mask:!1,closable:!1,closeAction:"destroy"});t.on("afterRenderUI",function(){var e=i(t.get("el"));e.append(i('<div class="arrow arrow-right"><i class="outer"></i><i class="inner"></i></div>')),e.on("click",function(e){i(e.target).hasClass("close")&&t.hide()}),setTimeout(function(){t.show()},500)}),t.render()}}}},{requires:["overlay"]}),KISSY.add("v2/source/service/list_v2",function(e){var a=e.DOM,r=e.Event;return{init:function(){var e=a.get("#J_DataTable");if(e){var t=a.query("div.alert-tips",e);if(t&&t.length)for(var n;n=t.shift();)this.tips(n);var i=a.query("input.selector",e),o=a.query("a.selector-btn",e);r.on(o,"mousedown",function(){for(var e,t=0;e=i[t];t++)e.value!=this.getAttribute("data-id")?e.checked=!1:e.checked=!0})}},tips:function(i){var e=a.get(".alert-tips-close",i),t=a.get(".alert-tips-btn",i);r.on(e,"click",function(e){a.remove(i),e.preventDefault(),e.stopPropagation()}),r.on(t,"click",function(e){var t=this.getAttribute("data-confirm"),n=this.getAttribute("data-url");n&&(t&&confirm(t)||!t)&&window.open(n),a.remove(i),e.preventDefault(),e.stopPropagation()})}}}),KISSY.add("v2/source/service/list_v3",function(t){var n=t.DOM,r=t.Event;return{init:function(){var o=n.get("#showcase-btn"),a=n.get("#showcase-input");if(o&&a){var e="//assets.alicdn.com/s/kissy/";"sell.daily.taobao.net"==document.domian&&(e="//assets.daily.taobao.net/s/kissy/"),t.config({packages:[{name:"gallery",path:e,charset:"utf-8"}]}),KISSY.use("tbc/showcase/0.0.2/index, node",function(e,t,n){var i=a.value;r.on(o,"click",function(e){e.preventDefault(),t.autoShowcase.show(i)}),t.autoShowcase.on("setShowcase:success",function(){setTimeout(function(){document.location.reload()},3e3)})})}}}}),KISSY.add("v2/source/service/cuntao",function(e,n){var i=e.all;return{init:function(){this._bindEvent()},_bindEvent:function(){var n=this,e=i(".J_Cuntao");e.length&&e.on("click",function(e){var t=i(this).attr("data-itemid");e.halt(),n.popup(t)}),i(window).on("message",function(e){switch(e.data){case"cuntao.close":n.dialog&&n.dialog.hide();break;case"cuntao.refresh":n.dialog&&n.dialog.hide(),window.location.reload()}})},popup:function(e){var t={headerContent:'<h2 class="overlay-title"><a class="close">X</a>\u8bbe\u7f6e\u519c\u6751\u6dd8\u5b9d\u670d\u52a1\u8d39\u6bd4\u4f8b</h2>',bodyContent:'<iframe src="'+["//",-1<location.host.indexOf("daily.taobao.net")?"cunsupplier.daily.taobao.net":"cunsupplier.taobao.com","/auction/cuntao/sellNestedForm.htm?itemId=",e].join("")+'"  frameborder=\u201dno\u201d border=\u201d0\u2033 scrolling=\u201dno\u201d></iframe>',elCls:"cuntao-overlay hint-default hint-overlay",mask:!0,width:550,closable:!1,zIndex:999999,closeAction:"destroy",align:{node:null,points:["cc","cc"],offset:[0,0]}};this.dialog=new n.Dialog(t),this.dialog.on("afterRenderUI",function(){var e=this;e.get("el").delegate("click",".close",function(){e.hide()})}),this.dialog.show()}}},{requires:["overlay"]}),KISSY.add("v2/service/main",function(e){var n=e.makeArray(arguments);e.ready(function(){for(var e=1;e<n.length;e++){var t=n[e]||{};t.init&&t.init()}})},{requires:["v2/source/service/searcharea","v2/source/service/lessquantity","v2/source/service/itemoperator","v2/source/service/itemsmanager","v2/source/service/qrcode","v2/source/service/recommend","v2/source/service/page","v2/source/service/mobileDesc","v2/source/service/weituan","v2/source/service/list_v2","v2/source/service/list_v3","v2/source/service/cuntao"]});